CC=gcc
CFLAGS= -Wall -g
LIBS= -lpthread

# Generate list of source files
SRC=$(wildcard src/*.c)
# Generate list of corresponding object files
OBJECTS=$(patsubst src/%.c, build/%.o, $(SRC))


# Handle files with source and header file
build/%.o: src/%.c include/%.h
	mkdir -p build
	$(CC) $(CFLAGS) -c $< -o $@

# Handle files with no header file associated
build/%.o: src/%.c
	mkdir -p build
	$(CC) $(CFLAGS) -c $< -o $@

# Build the main binary using the generated object files
build/main: $(OBJECTS)
	$(CC) $(CFLAGS) $(LIBS) $^ -o build/main

# Build the main binary and print a message
build: build/main
	@printf "\033[32mYou can now run ./build/main\n\033[0m"

all: build

clean :
	rm -rf build/
